Project 2
================
Group 6, Xavier Genelin, Dave Bergeron
10/19/2021

I don’t think we need all of these libraries. We can keep them for now
but the project doesn’t require anything with SQL so those can be
removed later.

Dave: Agree, one of my bad habits not pruning the list from one
assignment to the other.

# Introduction

We’ll load in the (Online News Popularity Data
Set)\[<https://archive.ics.uci.edu/ml/datasets/Online+News+Popularity>\]
from the UCI Machine Learning Repository. From this data, we’ll break it
down into 6 different groups based on the data channel: lifestyle,
entertainment, bus, socmed, tech, and world.

# Load Data and Make Groups

``` r
news <- read_csv("OnlineNewsPopularity.csv")
```

    ## Rows: 39644 Columns: 61

    ## -- Column specification ------
    ## Delimiter: ","
    ## chr  (1): url
    ## dbl (60): timedelta, n_tok...

    ## 
    ## i Use `spec()` to retrieve the full column specification for this data.
    ## i Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
# Remove the url column from the dataset
news <- news %>% select(!url)

# Subset data and remove the data_channel_is columns
## lifestyle
lifestyle <- news %>% filter(data_channel_is_lifestyle == 1) %>% select(!c(data_channel_is_bus, data_channel_is_entertainment, data_channel_is_lifestyle, data_channel_is_socmed, data_channel_is_tech, data_channel_is_world))

# entertainment
entertainment <- news %>% filter(data_channel_is_entertainment == 1) %>% select(!c(data_channel_is_bus, data_channel_is_entertainment, data_channel_is_lifestyle, data_channel_is_socmed, data_channel_is_tech, data_channel_is_world))

# bus
bus <- news %>% filter(data_channel_is_bus == 1) %>% select(!c(data_channel_is_bus, data_channel_is_entertainment, data_channel_is_lifestyle, data_channel_is_socmed, data_channel_is_tech, data_channel_is_world))

# socmed
socmed <- news %>% filter(data_channel_is_socmed == 1) %>% select(!c(data_channel_is_bus, data_channel_is_entertainment, data_channel_is_lifestyle, data_channel_is_socmed, data_channel_is_tech, data_channel_is_world))

# tech
tech <- news %>% filter(data_channel_is_tech == 1) %>% select(!c(data_channel_is_bus, data_channel_is_entertainment, data_channel_is_lifestyle, data_channel_is_socmed, data_channel_is_tech, data_channel_is_world))

# world
world <- news %>% filter(data_channel_is_world == 1) %>% select(!c(data_channel_is_bus, data_channel_is_entertainment, data_channel_is_lifestyle, data_channel_is_socmed, data_channel_is_tech, data_channel_is_world))
```

# Summarizations

``` r
# trying this with the world data set first.
set.seed(55)
trainIndex <- createDataPartition(world$shares, p = 0.7, list = FALSE)

# bus
busTrain <- bus[trainIndex, ]
busTest <- bus[-trainIndex, ]

# entertainment
entertainTrain <- entertainment[trainIndex, ]
entertainTest <- entertainment[-trainIndex, ]

# lifestyle 
lifestyleTrain <- lifestyle[trainIndex, ]
lifestyleTest <- lifestyle[-trainIndex, ]

# news 
newsTrain <- news[trainIndex, ]
newsTest <- news[-trainIndex, ]

# socmed 
socmedTrain <- socmed[trainIndex, ]
socmedTest <- socmed[-trainIndex, ]

# tech 
techTrain <- tech[trainIndex, ]
techTest <- tech[-trainIndex, ]

# world
worldTrain <- world[trainIndex, ]
worldTest <- world[-trainIndex, ]
```

I was hoping to see the correlation plot for the variables to see what
was most related to shares. Kind of rough with the large number of
variables

``` r
corrs <- cor(worldTrain)

corrplot(corrs, tl.cex = 0.5)
```

![](README_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

# EDA items

## Graphs

### Graph 1

``` r
# still working on this...need to play around with the data a bit more.
p <- ggplot(worldTrain, aes(x=shares)) + 
  geom_boxplot() + coord_flip()
p
```

![](README_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

### Graph 2

### Graph 3

## Contingency Tables

### 2-way Contingency Table

Shows token count in titles on Mondays

``` r
table(worldTrain$n_tokens_title, worldTrain$weekday_is_monday)
```

    ##     
    ##        0   1
    ##   4    2   0
    ##   5   14   2
    ##   6   73  21
    ##   7  216  32
    ##   8  467  95
    ##   9  728 155
    ##   10 915 185
    ##   11 919 184
    ##   12 719 136
    ##   13 497  76
    ##   14 239  26
    ##   15 113  17
    ##   16  42   5
    ##   17  15   3
    ##   18   2   0
    ##   19   1   0
    ##   23   1   0

### 3-Way Contingency Table

xxx

# Modeling

In this section we’re going to compare the following models: random
forest, linear regression, and two ensemble models (we can fill this in
when we decide which two to do). Each of the models will be trying to
predict the amount of shares for each of the data channels.

## Random Forest

Tried to use all the variables, took forever to run. Initially had 10 cv
and 1:15 trees. Made the cv to 5 and tried smaller mtry values but it
still takes a long time.

``` r
set.seed(55)
# takes forever to run
# rfFit <- train(shares ~ ., data = worldTrain, method = "rf", trControl = trainControl(method = "cv", number = 5), tuneGrid = expand.grid(mtry = 1:8))
```

## Linear Regression

``` r
#Model 1 -  Selecting predictors based on relevancy from ANOVA results after running the summary from model using all predictors in another model - 4 predictors
worldtrainglmfit <- lm(shares ~ num_imgs + kw_min_avg + kw_max_avg + kw_avg_avg, data = worldTrain, trControl = trainControl(method = "cv", number = 10), preProcess = c("center", "scale"))
```

    ## Warning: In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :
    ##  extra arguments 'trControl', 'preProcess' will be disregarded

``` r
pred1 <- predict(worldtrainglmfit, newdata = worldTest)

postResample(pred1, obs = worldTest$shares)
```

    ##         RMSE     Rsquared 
    ## 4.617892e+03 2.334528e-02 
    ##          MAE 
    ## 1.844947e+03

``` r
# Xavier model
olsFit <- train(shares ~ num_imgs + kw_min_avg + kw_max_avg + kw_avg_avg, data = worldTrain, trControl = trainControl(method = "cv", number = 5))

olsPred <- predict(olsFit, worldTest)

postResample(olsPred, obs = worldTest$shares)[2]
```

    ##   Rsquared 
    ## 0.04166473

## Ensemble

### Boosted Tree

This is the boosted tree model using all predictors in the `worldTrain`
data set.

``` r
set.seed(30)
wtFit <- train(shares ~ ., data = worldTrain,
               method = "gbm",
               preProcess = c("center", "scale"),
               trControl = trainControl(method = "cv",
                                        number = 5),
               tuneGrid = expand.grid(.n.trees = seq(25, 200, by = 25), .interaction.depth = seq(1, 4, by = 1), .shrinkage = (0.1), .n.minobsinnode = (10)))
```

    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 50899820.4566             nan     0.1000 17684.3620
    ##      2 50653601.9102             nan     0.1000 22934.2934
    ##      3 50485570.3182             nan     0.1000 -47516.4553
    ##      4 50282519.9131             nan     0.1000 31366.2773
    ##      5 50167179.3130             nan     0.1000 90280.0754
    ##      6 50031640.7140             nan     0.1000 27392.4491
    ##      7 49975016.7538             nan     0.1000 36862.2624
    ##      8 49902240.9559             nan     0.1000 50010.0461
    ##      9 49788325.8502             nan     0.1000 -56959.4391
    ##     10 49704622.0814             nan     0.1000 -86604.0887
    ##     20 49025885.6713             nan     0.1000 -9317.3772
    ##     40 48169643.9211             nan     0.1000 -70382.1604
    ##     60 47487684.9265             nan     0.1000 -14733.3054
    ##     80 46720299.4195             nan     0.1000 -190200.0253
    ##    100 46014071.3454             nan     0.1000 6769.5000
    ##    120 45597984.7723             nan     0.1000 -58964.6780
    ##    140 44997137.4197             nan     0.1000 8930.4542
    ##    160 44469802.5432             nan     0.1000 -24410.3072
    ##    180 43855065.5571             nan     0.1000 13520.2944
    ##    200 43296794.3200             nan     0.1000 52171.5990
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 51008284.8225             nan     0.1000 36455.5721
    ##      2 50719396.8564             nan     0.1000 89766.5695
    ##      3 50619172.6633             nan     0.1000 87028.1550
    ##      4 50369978.2726             nan     0.1000 76954.5469
    ##      5 49857555.5442             nan     0.1000 -36460.9139
    ##      6 49639257.6154             nan     0.1000 131583.9260
    ##      7 49387982.0721             nan     0.1000 -21731.7456
    ##      8 49262550.9913             nan     0.1000 29708.3585
    ##      9 48754535.6494             nan     0.1000 74621.6424
    ##     10 48554775.2426             nan     0.1000 -31709.9445
    ##     20 46416312.9173             nan     0.1000 58403.1138
    ##     40 42814962.0646             nan     0.1000 -145392.5054
    ##     60 40672833.1553             nan     0.1000 23054.1743
    ##     80 38910947.8401             nan     0.1000 -69982.3795
    ##    100 37207929.4490             nan     0.1000 -67138.0928
    ##    120 35885294.5143             nan     0.1000 -24994.2237
    ##    140 34873002.3737             nan     0.1000 -54844.0348
    ##    160 33693860.0693             nan     0.1000 -70193.2027
    ##    180 32555934.1315             nan     0.1000 -45485.0213
    ##    200 31893486.7786             nan     0.1000 -131348.6937
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 50561039.3467             nan     0.1000 38786.0723
    ##      2 50371254.7702             nan     0.1000 58810.0509
    ##      3 50097971.5404             nan     0.1000 -8269.2922
    ##      4 49841345.9676             nan     0.1000 -74497.9123
    ##      5 49159414.3143             nan     0.1000 -34180.6735
    ##      6 48646664.0616             nan     0.1000 157886.0998
    ##      7 48278561.1118             nan     0.1000 -13911.7689
    ##      8 47660348.4526             nan     0.1000 -112095.2355
    ##      9 47228822.1962             nan     0.1000 -109290.9529
    ##     10 46949618.2413             nan     0.1000 19041.2623
    ##     20 44709396.0464             nan     0.1000 -188664.0701
    ##     40 41501574.8826             nan     0.1000 -101630.4759
    ##     60 38844240.2130             nan     0.1000 -24119.8255
    ##     80 36659564.9380             nan     0.1000 -206316.1934
    ##    100 34486584.5538             nan     0.1000 -19698.3016
    ##    120 32894541.5292             nan     0.1000 -32933.3318
    ##    140 30977033.7337             nan     0.1000 9985.5918
    ##    160 29688502.9607             nan     0.1000 -44513.9043
    ##    180 28583797.6964             nan     0.1000 -52397.8274
    ##    200 27474601.5113             nan     0.1000 -30745.0880
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 50517451.8593             nan     0.1000 -26503.9506
    ##      2 50203973.3805             nan     0.1000 22358.2211
    ##      3 49655940.5853             nan     0.1000 229060.2390
    ##      4 49033314.6462             nan     0.1000 105005.8123
    ##      5 48606989.1828             nan     0.1000 28470.5574
    ##      6 48038942.1602             nan     0.1000 -119591.4081
    ##      7 47623841.3408             nan     0.1000 -45795.1178
    ##      8 47304440.5408             nan     0.1000 -150600.2526
    ##      9 47072110.0198             nan     0.1000 44143.5148
    ##     10 46668896.3596             nan     0.1000 -17897.3874
    ##     20 43013986.0202             nan     0.1000 -141608.4051
    ##     40 38725185.2792             nan     0.1000 -5586.4350
    ##     60 35920537.8302             nan     0.1000 -5680.1103
    ##     80 33223389.2172             nan     0.1000 -87531.4761
    ##    100 31341808.2716             nan     0.1000 -181074.2809
    ##    120 29819235.4219             nan     0.1000 -65521.9165
    ##    140 28173677.5537             nan     0.1000 -47630.8842
    ##    160 26791993.8499             nan     0.1000 -53852.3662
    ##    180 25732568.3123             nan     0.1000 -70844.1305
    ##    200 24449558.4558             nan     0.1000 -20807.3354
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 48827105.6930             nan     0.1000 6232.3436
    ##      2 48586580.1556             nan     0.1000 47223.3300
    ##      3 48343679.1879             nan     0.1000 -66235.7328
    ##      4 48251880.0657             nan     0.1000 92939.3200
    ##      5 48110410.6837             nan     0.1000 -48656.0265
    ##      6 47970137.7615             nan     0.1000 71765.6793
    ##      7 47877043.1822             nan     0.1000 38591.9458
    ##      8 47750317.7415             nan     0.1000 -55626.5531
    ##      9 47650219.1951             nan     0.1000 -76160.3247
    ##     10 47553221.2313             nan     0.1000 -72290.0390
    ##     20 46872707.7742             nan     0.1000 -140033.7263
    ##     40 45917192.3952             nan     0.1000 -28463.1623
    ##     60 45250531.1963             nan     0.1000 18212.6470
    ##     80 44606947.0450             nan     0.1000 -86152.2442
    ##    100 43897175.5342             nan     0.1000 -23986.4021
    ##    120 43315628.1489             nan     0.1000 -75148.2490
    ##    140 42889083.9673             nan     0.1000 9197.2295
    ##    160 42435911.0358             nan     0.1000 14228.0555
    ##    180 42013429.3910             nan     0.1000 -56493.7682
    ##    200 41492800.4173             nan     0.1000 69355.4934
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 48689806.5362             nan     0.1000 40225.4033
    ##      2 48115077.3013             nan     0.1000 -17356.9241
    ##      3 47960995.9159             nan     0.1000 -3144.0980
    ##      4 47775181.6858             nan     0.1000 162282.2728
    ##      5 47294294.8425             nan     0.1000 -92113.7080
    ##      6 46811751.7965             nan     0.1000 -153509.5692
    ##      7 46657487.8055             nan     0.1000 71044.0190
    ##      8 46504648.7958             nan     0.1000 -4653.8063
    ##      9 46164052.1843             nan     0.1000 -73046.8045
    ##     10 46020859.3703             nan     0.1000 15043.4061
    ##     20 44326239.6515             nan     0.1000 32268.1603
    ##     40 41976062.4937             nan     0.1000 -143596.1746
    ##     60 39708557.6719             nan     0.1000 -35774.1849
    ##     80 37654124.3864             nan     0.1000 -41157.8787
    ##    100 36004085.0982             nan     0.1000 -21378.6696
    ##    120 34666222.9283             nan     0.1000 -93774.2613
    ##    140 33703206.9472             nan     0.1000 -9387.0293
    ##    160 32747113.1008             nan     0.1000 -110164.4643
    ##    180 31712742.4603             nan     0.1000 16086.9008
    ##    200 30768036.6339             nan     0.1000 -19438.7844
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 48251637.1244             nan     0.1000 92337.5547
    ##      2 47883469.7921             nan     0.1000 31889.1788
    ##      3 47276227.5632             nan     0.1000 17383.9935
    ##      4 46706825.5848             nan     0.1000 -3156.3335
    ##      5 46536745.2878             nan     0.1000 83343.7288
    ##      6 46198394.7784             nan     0.1000 -32468.6501
    ##      7 45783787.9107             nan     0.1000 -140027.0344
    ##      8 45300421.6151             nan     0.1000 -30564.3566
    ##      9 44922627.8839             nan     0.1000 -96180.3379
    ##     10 44704259.7955             nan     0.1000 -32325.2805
    ##     20 41981006.5963             nan     0.1000 42559.4171
    ##     40 38161066.1345             nan     0.1000 105669.2799
    ##     60 35784739.9310             nan     0.1000 2248.1531
    ##     80 34012905.2000             nan     0.1000 -103126.0900
    ##    100 31698030.8620             nan     0.1000 -136319.2542
    ##    120 29794579.8548             nan     0.1000 -117840.4291
    ##    140 28638257.4229             nan     0.1000 -104054.0021
    ##    160 27463795.6183             nan     0.1000 -98366.1972
    ##    180 26462849.0603             nan     0.1000 -649.6493
    ##    200 25537311.5392             nan     0.1000 32700.5854
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 48599870.3163             nan     0.1000 38938.9907
    ##      2 47948209.4969             nan     0.1000 -46229.5698
    ##      3 47712623.5535             nan     0.1000 53509.1286
    ##      4 46992454.9465             nan     0.1000 61853.9879
    ##      5 46683540.8371             nan     0.1000 -61434.5248
    ##      6 46333746.1270             nan     0.1000 40314.5511
    ##      7 45771640.8463             nan     0.1000 -113100.8550
    ##      8 45243360.7187             nan     0.1000 -99963.2618
    ##      9 44709894.0515             nan     0.1000 -131376.2846
    ##     10 44489670.8694             nan     0.1000 -10327.9880
    ##     20 42412067.8580             nan     0.1000 -360478.1058
    ##     40 38460384.5565             nan     0.1000 -161448.4917
    ##     60 35127116.6646             nan     0.1000 54287.6841
    ##     80 32943275.4628             nan     0.1000 -3942.0433
    ##    100 31026513.1498             nan     0.1000 -15549.6229
    ##    120 28771284.7452             nan     0.1000 -53670.7612
    ##    140 27323496.4515             nan     0.1000 -79126.6847
    ##    160 25508557.9654             nan     0.1000 -38373.5459
    ##    180 24499168.6241             nan     0.1000 -16776.9116
    ##    200 23271112.3740             nan     0.1000 1520.3105
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 28938548.8946             nan     0.1000 46492.0978
    ##      2 28816696.3699             nan     0.1000 40472.8491
    ##      3 28751691.6855             nan     0.1000 65234.2103
    ##      4 28684189.7715             nan     0.1000 21748.4476
    ##      5 28649172.1260             nan     0.1000 6530.6030
    ##      6 28575788.1024             nan     0.1000 9115.5936
    ##      7 28504406.7864             nan     0.1000 -7924.3293
    ##      8 28432538.9206             nan     0.1000 13271.9305
    ##      9 28387442.3626             nan     0.1000 33559.3762
    ##     10 28333059.4825             nan     0.1000 5793.8694
    ##     20 27901533.5211             nan     0.1000 7203.2905
    ##     40 27454032.5064             nan     0.1000 -24662.4882
    ##     60 27154686.8418             nan     0.1000 -13187.8926
    ##     80 26984435.1535             nan     0.1000 -43745.0127
    ##    100 26795885.4903             nan     0.1000 7145.3000
    ##    120 26669544.8856             nan     0.1000 -40671.4812
    ##    140 26546097.6788             nan     0.1000 -27556.9979
    ##    160 26436467.5654             nan     0.1000 -25322.2538
    ##    180 26351270.6358             nan     0.1000 -17094.6844
    ##    200 26223165.0204             nan     0.1000 -28936.7743
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 28821978.7195             nan     0.1000 45669.0712
    ##      2 28593123.8926             nan     0.1000 15646.6010
    ##      3 28420396.0818             nan     0.1000 41923.4364
    ##      4 28309380.2347             nan     0.1000 -7548.8029
    ##      5 28195415.8835             nan     0.1000 43275.5663
    ##      6 27979004.3406             nan     0.1000 37684.4635
    ##      7 27832976.1234             nan     0.1000 -6101.0402
    ##      8 27536682.9795             nan     0.1000 -34646.8024
    ##      9 27433831.1604             nan     0.1000 44804.8877
    ##     10 27321767.2207             nan     0.1000 -17194.2787
    ##     20 26259235.9585             nan     0.1000 -41109.5662
    ##     40 25053713.5531             nan     0.1000 -9636.6125
    ##     60 24291315.8135             nan     0.1000 34369.5007
    ##     80 23653700.9381             nan     0.1000 -36795.8206
    ##    100 23296221.0469             nan     0.1000 -4851.2972
    ##    120 22821914.0736             nan     0.1000 -35873.4877
    ##    140 22461074.7935             nan     0.1000 -53665.3125
    ##    160 22091887.7052             nan     0.1000 -26679.4562
    ##    180 21574100.1888             nan     0.1000 -34304.5919
    ##    200 21143719.2802             nan     0.1000 -57656.4231
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 28697312.9439             nan     0.1000 26607.9743
    ##      2 28276938.4570             nan     0.1000 -25740.4063
    ##      3 28067798.5728             nan     0.1000 34987.8799
    ##      4 27979576.3382             nan     0.1000 -12858.7482
    ##      5 27718990.4831             nan     0.1000 2618.7538
    ##      6 27542479.1599             nan     0.1000 122261.9873
    ##      7 27305550.0267             nan     0.1000 28888.3250
    ##      8 27167231.7016             nan     0.1000 17170.9034
    ##      9 26963292.7202             nan     0.1000 39915.5117
    ##     10 26757021.4178             nan     0.1000 -17546.5146
    ##     20 25277077.5220             nan     0.1000 -42065.2334
    ##     40 23101696.1686             nan     0.1000 -16910.7857
    ##     60 22023418.8999             nan     0.1000 -129298.4251
    ##     80 20984163.4626             nan     0.1000 -37333.3000
    ##    100 20029152.0374             nan     0.1000 -22694.5833
    ##    120 19542865.9809             nan     0.1000 -14410.8401
    ##    140 18702341.4419             nan     0.1000 -40639.3680
    ##    160 18047888.4251             nan     0.1000 -23315.6211
    ##    180 17422848.1328             nan     0.1000 -28689.0305
    ##    200 16767754.9399             nan     0.1000 -51920.5701
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 28702706.9276             nan     0.1000 129094.0007
    ##      2 28409664.9438             nan     0.1000 -30835.4767
    ##      3 28211785.4858             nan     0.1000 65425.6802
    ##      4 27831254.8664             nan     0.1000 10224.0164
    ##      5 27614888.0230             nan     0.1000 -18026.3279
    ##      6 27509067.3140             nan     0.1000 9383.2557
    ##      7 27246053.3070             nan     0.1000 -57705.4313
    ##      8 26985620.4381             nan     0.1000 -58540.3220
    ##      9 26694706.9898             nan     0.1000 6495.7410
    ##     10 26525787.5326             nan     0.1000 4676.8043
    ##     20 24717501.3946             nan     0.1000 -50659.8384
    ##     40 22207609.0456             nan     0.1000 -36886.9515
    ##     60 20690074.0947             nan     0.1000 -25865.8941
    ##     80 19683610.1516             nan     0.1000 -60555.0656
    ##    100 18726910.0008             nan     0.1000 -25985.1543
    ##    120 17666544.2163             nan     0.1000 -49335.0649
    ##    140 16614222.9529             nan     0.1000 -17606.0572
    ##    160 15982424.0022             nan     0.1000 -5006.0909
    ##    180 15343193.4269             nan     0.1000 -47891.0126
    ##    200 14632182.6063             nan     0.1000 -15306.7948
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 51868452.1575             nan     0.1000 -11426.5914
    ##      2 51628367.1193             nan     0.1000 88971.4598
    ##      3 51500061.2986             nan     0.1000 47844.1227
    ##      4 51293560.1332             nan     0.1000 -12229.4501
    ##      5 51189467.9238             nan     0.1000 -6128.9619
    ##      6 51138181.1116             nan     0.1000 -12603.8959
    ##      7 51025772.5185             nan     0.1000 104571.5497
    ##      8 50918187.1124             nan     0.1000 102125.4490
    ##      9 50755808.5636             nan     0.1000 -39379.1869
    ##     10 50678157.2642             nan     0.1000 -23433.6107
    ##     20 50002741.8582             nan     0.1000 -26601.2487
    ##     40 49121977.7298             nan     0.1000 81208.0896
    ##     60 48281263.9076             nan     0.1000 12663.4012
    ##     80 47682271.1350             nan     0.1000 -29729.8612
    ##    100 47094995.9816             nan     0.1000 30322.1388
    ##    120 46645413.0207             nan     0.1000 -38937.9055
    ##    140 46194536.4062             nan     0.1000 -31296.8767
    ##    160 45648341.8073             nan     0.1000 -50998.8434
    ##    180 45134793.4670             nan     0.1000 -53780.2280
    ##    200 44731489.8517             nan     0.1000 -75826.4517
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 51323137.0622             nan     0.1000 16479.7954
    ##      2 51073942.2697             nan     0.1000 81290.1804
    ##      3 50616256.2228             nan     0.1000 -37486.4473
    ##      4 50145249.1499             nan     0.1000 -62332.6601
    ##      5 49996720.5017             nan     0.1000 74781.2065
    ##      6 49593053.4381             nan     0.1000 -116100.5354
    ##      7 49460275.6400             nan     0.1000 62168.5337
    ##      8 49271674.8943             nan     0.1000 14523.6033
    ##      9 48989028.9532             nan     0.1000 -141058.8516
    ##     10 48758008.1166             nan     0.1000 -34938.7818
    ##     20 45815268.2757             nan     0.1000 9971.9385
    ##     40 42919137.5326             nan     0.1000 -80545.4890
    ##     60 40285701.0892             nan     0.1000 -13550.1282
    ##     80 38381493.1679             nan     0.1000 -74179.2904
    ##    100 36840384.8432             nan     0.1000 -142153.3698
    ##    120 35774571.9801             nan     0.1000 -82691.4316
    ##    140 34677249.3898             nan     0.1000 -63888.2184
    ##    160 33820370.0256             nan     0.1000 -29500.3962
    ##    180 33261794.7786             nan     0.1000 -48974.0384
    ##    200 32504556.6285             nan     0.1000 -129986.3926
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 51415359.0122             nan     0.1000 113057.6381
    ##      2 50738135.1839             nan     0.1000 115537.0981
    ##      3 50441138.1836             nan     0.1000 43652.7100
    ##      4 49877274.6912             nan     0.1000 1020.5601
    ##      5 49389759.2502             nan     0.1000 -18210.4599
    ##      6 49093478.0791             nan     0.1000 -63959.0639
    ##      7 48601768.0245             nan     0.1000 -104385.9974
    ##      8 48360265.0913             nan     0.1000 31731.7728
    ##      9 48145911.2359             nan     0.1000 -26053.7345
    ##     10 47893595.8318             nan     0.1000 92287.4268
    ##     20 45206575.4801             nan     0.1000 -24060.6488
    ##     40 41733819.5694             nan     0.1000 -53653.1360
    ##     60 39009109.9274             nan     0.1000 -9923.0540
    ##     80 36758720.7873             nan     0.1000 2736.7422
    ##    100 35180399.9374             nan     0.1000 -35845.0687
    ##    120 33194564.0156             nan     0.1000 -140430.0695
    ##    140 32047859.1224             nan     0.1000 3455.1879
    ##    160 30541055.4073             nan     0.1000 -7155.5736
    ##    180 29198016.5404             nan     0.1000 -42261.1408
    ##    200 28181393.5251             nan     0.1000 -63863.1454
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 51818163.0303             nan     0.1000 51866.2525
    ##      2 51597076.9022             nan     0.1000 25927.2948
    ##      3 50732668.8251             nan     0.1000 -91596.8717
    ##      4 50134305.8604             nan     0.1000 -67701.6649
    ##      5 49909908.4981             nan     0.1000 80839.3811
    ##      6 49215184.8013             nan     0.1000 -51742.5882
    ##      7 48912758.4457             nan     0.1000 216392.9242
    ##      8 48298896.1749             nan     0.1000 10986.5727
    ##      9 47712953.4778             nan     0.1000 -201464.5529
    ##     10 47532510.0659             nan     0.1000 -39479.9874
    ##     20 44765710.3706             nan     0.1000 -31475.0958
    ##     40 40510171.0892             nan     0.1000 -11286.7579
    ##     60 36504352.4225             nan     0.1000 -178419.1704
    ##     80 33291841.1133             nan     0.1000 -6323.2713
    ##    100 31027583.5091             nan     0.1000 -569.4367
    ##    120 29522190.3221             nan     0.1000 -81145.8023
    ##    140 28222767.2272             nan     0.1000 -42460.9034
    ##    160 26707896.1045             nan     0.1000 -125315.0902
    ##    180 25393555.1032             nan     0.1000 -10270.8329
    ##    200 24246224.7196             nan     0.1000 -104435.2429
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 36947008.9529             nan     0.1000 61811.0040
    ##      2 36869966.4752             nan     0.1000 9931.2868
    ##      3 36802091.5650             nan     0.1000 46369.5549
    ##      4 36660937.9632             nan     0.1000 6458.9656
    ##      5 36471711.6765             nan     0.1000 85126.8321
    ##      6 36397065.7265             nan     0.1000 88778.8926
    ##      7 36277534.8445             nan     0.1000 -40076.2124
    ##      8 36201556.4365             nan     0.1000 84056.4166
    ##      9 36034696.6447             nan     0.1000 56214.4035
    ##     10 35954679.8132             nan     0.1000 -77072.3674
    ##     20 35430696.7453             nan     0.1000 -32879.1060
    ##     40 34660181.5941             nan     0.1000 -5215.9646
    ##     60 33762190.6868             nan     0.1000 -208386.1916
    ##     80 33055392.5052             nan     0.1000 -65169.5652
    ##    100 32428584.7586             nan     0.1000 -166782.9956
    ##    120 31911152.3847             nan     0.1000 -93007.6839
    ##    140 31245632.2538             nan     0.1000 -83208.3919
    ##    160 30505130.8463             nan     0.1000 -66124.0677
    ##    180 29997317.5359             nan     0.1000 38641.6266
    ##    200 29594992.5026             nan     0.1000 -13320.7442
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 36816555.8554             nan     0.1000 36428.1993
    ##      2 36614744.4571             nan     0.1000 84970.9512
    ##      3 36467618.2099             nan     0.1000 114289.9219
    ##      4 35853215.5468             nan     0.1000 89573.1844
    ##      5 35741588.8577             nan     0.1000 35706.7851
    ##      6 35662878.1689             nan     0.1000 -19073.6197
    ##      7 35502110.4527             nan     0.1000 31289.6002
    ##      8 35358725.2461             nan     0.1000 40586.1324
    ##      9 35266119.1976             nan     0.1000 -16347.2054
    ##     10 35238417.4705             nan     0.1000 -21127.9148
    ##     20 33490008.8520             nan     0.1000 -84594.4481
    ##     40 30909702.6262             nan     0.1000 -67439.0070
    ##     60 28487054.4148             nan     0.1000 -62216.0516
    ##     80 27077251.4254             nan     0.1000 60340.9006
    ##    100 25787940.9323             nan     0.1000 -49400.5614
    ##    120 24422560.8325             nan     0.1000 9227.2618
    ##    140 23174580.2743             nan     0.1000 11442.6243
    ##    160 22270399.4478             nan     0.1000 -153533.5801
    ##    180 21503779.1207             nan     0.1000 -26470.9020
    ##    200 20797688.2964             nan     0.1000 -35403.2199
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 36855354.8272             nan     0.1000 56023.3169
    ##      2 36685629.8018             nan     0.1000 49676.7773
    ##      3 36540599.7415             nan     0.1000 75801.8125
    ##      4 36462603.5501             nan     0.1000 -5515.3616
    ##      5 36341632.5512             nan     0.1000 14815.9129
    ##      6 36207554.2779             nan     0.1000 40626.0983
    ##      7 35977378.5438             nan     0.1000 -35823.8964
    ##      8 35843156.6655             nan     0.1000 37092.1896
    ##      9 35679723.1921             nan     0.1000 -31723.7553
    ##     10 35165523.4721             nan     0.1000 87329.4872
    ##     20 33525460.7491             nan     0.1000 24582.3321
    ##     40 31357637.7714             nan     0.1000 -95754.3291
    ##     60 28590175.5018             nan     0.1000 18156.0001
    ##     80 26978351.0946             nan     0.1000 -149047.2710
    ##    100 24846016.1031             nan     0.1000 -88702.0350
    ##    120 23014958.8055             nan     0.1000 -151055.1227
    ##    140 21695165.5294             nan     0.1000 3720.9535
    ##    160 20543504.1325             nan     0.1000 -119546.4429
    ##    180 19643563.0155             nan     0.1000 -44507.2183
    ##    200 18812955.3819             nan     0.1000 -8698.0088
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 36820093.6110             nan     0.1000 147407.8300
    ##      2 35989084.7921             nan     0.1000 123799.1749
    ##      3 35595961.7424             nan     0.1000 -32712.5822
    ##      4 35495064.7513             nan     0.1000 37463.1722
    ##      5 34898960.1115             nan     0.1000 60464.6160
    ##      6 34366170.9845             nan     0.1000 -154785.4744
    ##      7 34278202.2518             nan     0.1000 36097.5172
    ##      8 33822712.4661             nan     0.1000 -51552.0709
    ##      9 33387561.9477             nan     0.1000 -324853.3985
    ##     10 33249426.1990             nan     0.1000 25217.1050
    ##     20 31693459.3323             nan     0.1000 -152646.1216
    ##     40 28808165.7714             nan     0.1000 -45564.5768
    ##     60 26180694.9046             nan     0.1000 -99582.0393
    ##     80 24367167.3955             nan     0.1000 10290.2068
    ##    100 22396134.0548             nan     0.1000 -163637.3698
    ##    120 20868388.2452             nan     0.1000 -36954.0090
    ##    140 19284771.2065             nan     0.1000 -14459.9236
    ##    160 18116291.0339             nan     0.1000 -66945.4186
    ##    180 17082945.7981             nan     0.1000 -34401.0970
    ##    200 16428820.0295             nan     0.1000 -8775.5174
    ## 
    ## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
    ##      1 43564849.5571             nan     0.1000 9520.5888
    ##      2 43393306.4875             nan     0.1000 20774.2917
    ##      3 43299196.3257             nan     0.1000 92965.8976
    ##      4 43163938.7714             nan     0.1000 -11457.4975
    ##      5 43084058.7498             nan     0.1000 37719.4699
    ##      6 42956517.7153             nan     0.1000  213.8466
    ##      7 42866132.4986             nan     0.1000 -41524.1491
    ##      8 42775060.6122             nan     0.1000 12071.1598
    ##      9 42700871.9766             nan     0.1000 -50232.6871
    ##     10 42611148.9397             nan     0.1000 -3718.1881
    ##     20 42088355.1626             nan     0.1000 6272.5115
    ##     40 41418892.0378             nan     0.1000 6992.4678
    ##     60 40889262.7359             nan     0.1000 40631.7810
    ##     75 40500245.2754             nan     0.1000 55263.7366

``` r
wtFit
```

    ## Stochastic Gradient Boosting 
    ## 
    ## 5900 samples
    ##   53 predictor
    ## 
    ## Pre-processing:
    ##  centered (53), scaled (53) 
    ## Resampling: Cross-Validated (5 fold) 
    ## Summary of sample sizes: 4720, 4721, 4720, 4719, 4720 
    ## Resampling results across tuning parameters:
    ## 
    ##   interaction.depth  n.trees
    ##   1                   25    
    ##   1                   50    
    ##   1                   75    
    ##   1                  100    
    ##   1                  125    
    ##   1                  150    
    ##   1                  175    
    ##   1                  200    
    ##   2                   25    
    ##   2                   50    
    ##   2                   75    
    ##   2                  100    
    ##   2                  125    
    ##   2                  150    
    ##   2                  175    
    ##   2                  200    
    ##   3                   25    
    ##   3                   50    
    ##   3                   75    
    ##   3                  100    
    ##   3                  125    
    ##   3                  150    
    ##   3                  175    
    ##   3                  200    
    ##   4                   25    
    ##   4                   50    
    ##   4                   75    
    ##   4                  100    
    ##   4                  125    
    ##   4                  150    
    ##   4                  175    
    ##   4                  200    
    ##   RMSE      Rsquared  
    ##   6004.788  0.01531058
    ##   6025.393  0.01774463
    ##   5999.578  0.02240505
    ##   6002.997  0.02404910
    ##   6008.535  0.02423892
    ##   6021.922  0.02359794
    ##   6023.811  0.02379314
    ##   6028.176  0.02327317
    ##   6026.404  0.01708098
    ##   6085.781  0.01744801
    ##   6101.042  0.01813199
    ##   6142.999  0.01857463
    ##   6163.131  0.01867983
    ##   6165.773  0.02036632
    ##   6172.419  0.01964205
    ##   6180.394  0.01966794
    ##   6038.138  0.01602644
    ##   6081.296  0.01976207
    ##   6124.927  0.02105449
    ##   6133.826  0.02354316
    ##   6180.500  0.02201114
    ##   6215.802  0.02086062
    ##   6248.363  0.01996914
    ##   6280.281  0.02054582
    ##   6036.785  0.02401938
    ##   6089.200  0.02269479
    ##   6114.716  0.02592751
    ##   6159.058  0.02438653
    ##   6157.253  0.02679678
    ##   6164.012  0.02905396
    ##   6173.106  0.02725081
    ##   6213.627  0.02752012
    ##   MAE     
    ##   1971.980
    ##   1974.256
    ##   1956.569
    ##   1947.547
    ##   1955.822
    ##   1960.546
    ##   1968.121
    ##   1958.801
    ##   1970.548
    ##   1981.894
    ##   1985.363
    ##   1993.887
    ##   1996.555
    ##   2002.527
    ##   2009.366
    ##   2010.979
    ##   1963.067
    ##   1966.224
    ##   1989.114
    ##   1998.705
    ##   2022.306
    ##   2039.251
    ##   2067.920
    ##   2082.095
    ##   1968.924
    ##   1974.771
    ##   1985.900
    ##   2025.960
    ##   2027.231
    ##   2047.584
    ##   2064.852
    ##   2091.244
    ## 
    ## Tuning parameter
    ##  held constant at a value
    ##  of 10
    ## RMSE was used to select
    ##  the optimal model using
    ##  the smallest value.
    ## The final values used for
    ##  1, shrinkage = 0.1
    ##  and n.minobsinnode = 10.

#### Boosted Tree Test Results

xxxx

# Comparison

## Test for project 2

Test
